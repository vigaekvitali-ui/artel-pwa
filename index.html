<!DOCTYPE html>
<html lang="ru" x-data="appState" :class="theme">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ARTEL | –°–ò–ù–Ø–Ø –ò–ó–û–õ–ï–ù–¢–ê</title>
    
    <meta name="theme-color" content="#0052cc">
    <link rel="manifest" href="manifest.json">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <style>
        [x-cloak] { display: none !important; }
        
        /* –¶–≤–µ—Ç–æ–≤—ã–µ —Å—Ö–µ–º—ã —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ */
        :root { --accent: #0052cc; --bg: #f1f5f9; --card: #ffffff; --text: #1e293b; --border: #e2e8f0; }
        .theme-dark { --bg: #0f172a; --card: #1e293b; --text: #f8fafc; --border: #334155; --accent: #3b82f6; }
        .theme-grease { --bg: #1c1917; --card: #292524; --text: #e7e5e4; --accent: #f59e0b; --border: #44403c; }
        .theme-blueprint { --bg: #1e3a8a; --card: #1e40af; --text: #ffffff; --accent: #ffffff; --border: #3b82f6; }
        .theme-safety { --bg: #000000; --card: #111111; --text: #ffffff; --accent: #fbbf24; --border: #fbbf24; }

        body { background-color: var(--bg); color: var(--text); transition: all 0.3s ease; }
        .card { background-color: var(--card); border: 1px solid var(--border); border-radius: 1rem; }
        .btn-accent { background-color: var(--accent); color: white; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ */
        .ref-table th { background: rgba(0,0,0,0.05); text-transform: uppercase; font-size: 0.7rem; padding: 0.75rem; }
        .ref-table td { padding: 0.75rem; border-bottom: 1px solid var(--border); font-family: 'JetBrains Mono', monospace; }
    </style>
</head>
<body class="min-h-screen font-sans antialiased pb-24">

    <header class="fixed top-0 w-full z-40 p-4 flex justify-between items-center bg-[var(--card)] border-b border-[var(--border)] shadow-sm">
        <div class="flex items-center gap-2">
            <div class="w-8 h-8 flex items-center justify-center rounded-lg bg-blue-600">
                <i data-lucide="layers" class="text-white w-5 h-5"></i>
            </div>
            <h1 class="font-black text-lg tracking-tight">ARTEL <span class="font-light opacity-60">PWA</span></h1>
        </div>
        <button @click="showSettings = true" class="p-2 rounded-full hover:bg-black/5">
            <i data-lucide="settings"></i>
        </button>
    </header>

    <main class="pt-20 px-4 max-w-3xl mx-auto" @touchstart="handleTouchStart" @touchend="handleTouchEnd">
        
        <div x-show="page === 'cal'" x-cloak class="space-y-4">
            <div class="card p-4 shadow-sm">
                <div class="flex justify-between items-center mb-4">
                    <button @click="changeMonth(-1)" class="p-2"><i data-lucide="chevron-left"></i></button>
                    <h2 class="font-bold text-lg" x-text="monthLabel"></h2>
                    <button @click="changeMonth(1)" class="p-2"><i data-lucide="chevron-right"></i></button>
                </div>
                <div class="grid grid-cols-7 gap-1 text-center text-xs">
                    <template x-for="d in ['–ü–Ω','–í—Ç','–°—Ä','–ß—Ç','–ü—Ç','–°–±','–í—Å']"><div class="font-bold opacity-40 py-2" x-text="d"></div></template>
                    <template x-for="_ in blankDays"><div></div></template>
                    <template x-for="day in daysInMonth">
                        <div :class="getDayClass(day)" class="aspect-square flex items-center justify-center rounded-lg cursor-pointer" x-text="day"></div>
                    </template>
                </div>
            </div>
            <div class="card p-4 border-l-4 border-blue-500 bg-blue-50/50">
                <p class="text-xs uppercase font-bold opacity-50 mb-1">–ó–∞–∫–æ–Ω –ú–µ—Ä—Ñ–∏ –¥–Ω—è</p>
                <p class="text-sm italic" x-text="dailyQuote"></p>
            </div>
        </div>

        <div x-show="page === 'chat'" x-cloak class="flex flex-col h-[70vh]">
            <div class="flex-1 overflow-y-auto space-y-3 no-scrollbar">
                <template x-for="m in messages">
                    <div :class="m.self ? 'ml-auto bg-blue-600 text-white' : 'card'" class="max-w-[85%] p-3 text-sm rounded-2xl">
                        <p x-text="m.text"></p>
                    </div>
                </template>
            </div>
            <div class="mt-4 flex gap-2">
                <input type="text" placeholder="–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è..." class="flex-1 card px-4 py-3 outline-none focus:ring-2 focus:ring-blue-500">
                <button class="w-12 h-12 rounded-xl bg-blue-600 text-white flex items-center justify-center"><i data-lucide="send"></i></button>
            </div>
        </div>

        <div x-show="page === 'stock'" x-cloak class="space-y-4">
            <div class="flex gap-2 overflow-x-auto no-scrollbar">
                <template x-for="cat in ['–£ –º–µ–Ω—è –µ—Å—Ç—å', '–ú–Ω–µ –Ω—É–∂–Ω–æ', '–ú–æ–≥—É –ø–æ–¥–µ–ª–∏—Ç—å—Å—è']">
                    <button @click="stockFilter = cat" :class="stockFilter === cat ? 'bg-blue-600 text-white' : 'card'" class="px-4 py-2 rounded-full text-xs whitespace-nowrap" x-text="cat"></button>
                </template>
            </div>
            <div class="grid gap-2">
                <template x-for="item in inventory.filter(i => i.cat === stockFilter)">
                    <div class="card p-4 flex justify-between items-center">
                        <div>
                            <p class="font-bold" x-text="item.name"></p>
                            <p class="text-[10px] opacity-50" x-text="item.details"></p>
                        </div>
                        <i data-lucide="box" class="opacity-20"></i>
                    </div>
                </template>
            </div>
        </div>

        <div x-show="page === 'ref'" x-cloak class="space-y-4">
            <select x-model="refType" class="w-full card p-3 outline-none">
                <option value="metric">–ú–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑—å–±—ã (M)</option>
                <option value="inch">–î—é–π–º–æ–≤—ã–µ (UNC/UNF)</option>
                <option value="bearings">–ü–æ–¥—à–∏–ø–Ω–∏–∫–∏ –∫–∞—á–µ–Ω–∏—è</option>
                <option value="seals">–°–∞–ª—å–Ω–∏–∫–∏ –∏ –º–∞–Ω–∂–µ—Ç—ã</option>
            </select>
            <div class="card overflow-hidden shadow-sm overflow-x-auto">
                <table class="w-full text-xs ref-table">
                    <thead>
                        <template x-if="refType === 'metric' || refType === 'inch'">
                            <tr><th>–†–∞–∑–º–µ—Ä</th><th>–®–∞–≥</th><th>–°–≤–µ—Ä–ª–æ</th></tr>
                        </template>
                        <template x-if="refType === 'bearings'">
                            <tr><th>‚Ññ</th><th>d</th><th>D</th><th>B (–º–º)</th></tr>
                        </template>
                        <template x-if="refType === 'seals'">
                            <tr><th>–¢–∏–ø</th><th>d x D x H</th><th>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ</th></tr>
                        </template>
                    </thead>
                    <tbody>
                        <template x-for="row in getRefData()">
                            <tr>
                                <template x-for="val in Object.values(row)">
                                    <td x-text="val"></td>
                                </template>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </div>
        </div>

        <div x-show="page === 'obd'" x-cloak class="space-y-4">
            <input type="text" x-model="obdCode" placeholder="–ö–æ–¥ –æ—à–∏–±–∫–∏ (P0101, 520204...)" class="w-full card p-4 uppercase font-mono">
            <div class="card p-6 bg-slate-900 text-green-500 font-mono shadow-xl border-none min-h-[120px]">
                <template x-if="obdCode.length >= 3">
                    <div>
                        <p class="text-white text-xs mb-2 underline tracking-widest">DIAGNOSTIC_REPORT:</p>
                        <p x-text="searchOBD()"></p>
                    </div>
                </template>
                <template x-if="obdCode.length < 3">
                    <p class="opacity-40 italic text-sm">–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ —Å–∏—Å—Ç–µ–º—ã...</p>
                </template>
            </div>
        </div>

        <div x-show="page === 'ai'" x-cloak class="space-y-4">
            <div class="grid grid-cols-2 gap-3">
                <a href="https://gemini.google.com" target="_blank" class="card p-4 flex flex-col items-center justify-center gap-2">
                    <i data-lucide="sparkles" class="text-blue-500"></i><span class="text-xs font-bold">Gemini</span>
                </a>
                <a href="https://notebooklm.google.com" target="_blank" class="card p-4 flex flex-col items-center justify-center gap-2">
                    <i data-lucide="book-open-check" class="text-purple-500"></i><span class="text-xs font-bold">NotebookLM</span>
                </a>
            </div>
            <div class="card p-4 bg-gradient-to-br from-blue-600 to-blue-800 text-white border-none">
                <p class="text-xs font-bold uppercase opacity-60 mb-2">Prompt Library</p>
                <p class="text-sm italic">"–†–∞—Å—Å—á–∏—Ç–∞–π –¥–æ–ø—É—Å–∫ –ø–æ—Å–∞–¥–∫–∏ –¥–ª—è –≤–∞–ª–∞ 45–º–º –ø–æ–¥ –ø–æ–¥—à–∏–ø–Ω–∏–∫ 6209 –ø–æ —Å–∏—Å—Ç–µ–º–µ –≤–∞–ª–∞..."</p>
                <button class="mt-4 px-3 py-1 bg-white/20 rounded-md text-[10px]">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
        </div>

        <div x-show="page === 'joke'" x-cloak class="space-y-4">
            <template x-for="j in jokes">
                <div class="card p-4 space-y-3">
                    <p class="text-sm leading-relaxed" x-text="j.text"></p>
                    <div class="flex justify-between items-center border-t border-[var(--border)] pt-3">
                        <span class="text-[10px] opacity-40 uppercase tracking-widest">#engineering_humor</span>
                        <button class="text-xs text-blue-500 font-bold" @click="j.rating++">üòÇ <span x-text="j.rating"></span></button>
                    </div>
                </div>
            </template>
        </div>

    </main>

    <nav class="fixed bottom-0 w-full bg-[var(--card)] border-t border-[var(--border)] p-2 flex justify-around items-center z-40">
        <template x-for="p in tabs">
            <button @click="page = p.id" :class="page === p.id ? 'text-blue-600' : 'text-slate-400 opacity-50'" class="flex flex-col items-center gap-1 transition-all">
                <i :data-lucide="p.icon" class="w-5 h-5"></i>
                <span class="text-[8px] font-bold uppercase" x-text="p.title"></span>
            </button>
        </template>
    </nav>

    <div x-show="showSettings" x-transition x-cloak class="fixed inset-0 z-50 bg-black/60 backdrop-blur-sm flex items-end sm:items-center justify-center p-4">
        <div @click.away="showSettings = false" class="card w-full max-w-md p-6 bg-[var(--card)]">
            <h3 class="text-xl font-bold mb-4">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã</h3>
            <div class="space-y-4">
                <label class="text-xs font-bold opacity-50 block uppercase">–¶–≤–µ—Ç–æ–≤–∞—è —Ç–µ–º–∞</label>
                <div class="grid grid-cols-5 gap-2">
                    <button @click="theme = ''" class="h-10 rounded-lg bg-blue-600 border-2 border-white"></button>
                    <button @click="theme = 'theme-dark'" class="h-10 rounded-lg bg-slate-800 border-2 border-white"></button>
                    <button @click="theme = 'theme-grease'" class="h-10 rounded-lg bg-orange-900 border-2 border-white"></button>
                    <button @click="theme = 'theme-blueprint'" class="h-10 rounded-lg bg-blue-800 border-2 border-white"></button>
                    <button @click="theme = 'theme-safety'" class="h-10 rounded-lg bg-yellow-400 border-2 border-white"></button>
                </div>
                <div class="text-center p-4 bg-white rounded-xl">
                    <p class="text-xs mb-2 font-bold text-black uppercase opacity-40">–ü–æ–¥–∫–ª—é—á–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</p>
                    <img :src="'https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=' + window.location.href" class="mx-auto w-32 h-32">
                </div>
            </div>
            <button @click="showSettings = false" class="w-full btn-accent py-4 rounded-xl font-bold mt-6">–ü—Ä–∏–Ω—è—Ç—å</button>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
