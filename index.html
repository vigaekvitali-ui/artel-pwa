<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–°–∏–Ω—è—è –ò–∑–æ–ª–µ–Ω—Ç–∞ ‚Äî –ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–π —Ö–∞–±</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* --- –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –¶–í–ï–¢–û–í–´–• –¢–ï–ú --- */
        :root { --main-blue: #0038a8; --bg: #f3f4f6; --text: #1f2937; --card: #ffffff; }
        
        body.theme-classic { --main-blue: #0038a8; --bg: #f3f4f6; --text: #1f2937; --card: #ffffff; }
        body.theme-dark { --main-blue: #3b82f6; --bg: #111827; --text: #f9fafb; --card: #1f2937; }
        body.theme-metal { --main-blue: #64748b; --bg: #cbd5e1; --text: #0f172a; --card: #f1f5f9; }
        body.theme-safety { --main-blue: #fbbf24; --bg: #fffbeb; --text: #78350f; --card: #ffffff; }
        body.theme-garage { --main-blue: #ef4444; --bg: #18181b; --text: #fafafa; --card: #27272a; }

        body { background-color: var(--bg); color: var(--text); font-family: 'Segoe UI', system-ui, sans-serif; transition: 0.3s; }
        .page { display: none; padding: 20px; padding-bottom: 100px; min-height: 100vh; }
        .page.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .nav-bar { position: fixed; bottom: 0; width: 100%; background: var(--card); border-top: 2px solid var(--main-blue); display: flex; justify-content: space-around; padding: 10px; z-index: 1000; }
        .nav-btn { font-size: 0.7rem; display: flex; flex-direction: column; align-items: center; opacity: 0.6; }
        .nav-btn.active { opacity: 1; color: var(--main-blue); font-weight: bold; }

        .card { background: var(--card); border-radius: 12px; padding: 15px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); margin-bottom: 15px; }
        .btn-action { background: var(--main-blue); color: white; padding: 10px 20px; border-radius: 8px; font-weight: bold; width: 100%; }

        /* –°—Ç–∏–ª–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è */
        .calendar-grid { display: grid; grid-template-cols: repeat(7, 1fr); gap: 5px; text-align: center; }
        .day { padding: 10px 0; border-radius: 6px; font-size: 0.9rem; border: 1px solid rgba(0,0,0,0.05); }
        .day.holiday { color: #ef4444; font-weight: bold; }
        .day.today { background: var(--main-blue); color: white; }
    </style>
</head>
<body class="theme-classic">

    <header class="p-4 flex justify-between items-center shadow-md bg-[var(--card)]">
        <div class="flex items-center gap-2">
            <div id="app-logo" style="width: 40px;"></div>
            <h1 class="font-bold text-lg leading-tight">–°–ò–ù–Ø–Ø<br><span style="color:var(--main-blue)">–ò–ó–û–õ–ï–ù–¢–ê</span></h1>
        </div>
        <button onclick="openSettings()" class="text-2xl">‚öôÔ∏è</button>
    </header>

    <main id="app-content">
        <section id="page-calendar" class="page active">
            <div class="card">
                <div class="flex justify-between items-center mb-4">
                    <h2 id="month-title" class="text-xl font-bold">–§–µ–≤—Ä–∞–ª—å 2026</h2>
                    <div class="flex gap-2">
                        <button onclick="moveMonth(-1)">‚óÄ</button>
                        <button onclick="moveMonth(1)">‚ñ∂</button>
                    </div>
                </div>
                <div class="calendar-grid mb-2 opacity-50 text-xs">
                    <span>–ü–Ω</span><span>–í—Ç</span><span>–°—Ä</span><span>–ß—Ç</span><span>–ü—Ç</span><span class="text-red-500">–°–±</span><span class="text-red-500">–í—Å</span>
                </div>
                <div id="calendar-body" class="calendar-grid"></div>
            </div>
            <div class="card border-l-4 border-blue-600 italic text-sm" id="daily-quote">
                "–í—Å—ë, —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫, –ø–æ–π–¥–µ—Ç –Ω–µ —Ç–∞–∫." (–ó–∞–∫–æ–Ω –ú—ë—Ä—Ñ–∏)
            </div>
        </section>

        <section id="page-chat" class="page">
            <h2 class="text-xl font-bold mb-4">–ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç</h2>
            <div id="chat-messages" class="card h-64 overflow-y-auto space-y-2 mb-4"></div>
            <div class="flex gap-2">
                <input type="text" id="chat-input" class="flex-1 p-2 rounded border bg-[var(--card)]" placeholder="–¢–µ–∫—Å—Ç...">
                <button onclick="sendMessage()" class="p-2 bg-blue-600 text-white rounded">üíæ</button>
            </div>
        </section>

        <section id="page-warehouse" class="page">
            <h2 class="text-xl font-bold mb-4">–°–∫–ª–∞–¥ –ø–æ–¥ –≤–µ—Ä—Å—Ç–∞–∫–æ–º</h2>
            <div id="warehouse-list" class="space-y-3"></div>
            <button onclick="addPart()" class="btn-action mt-4">+ –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å/–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç</button>
        </section>

        <section id="page-handbook" class="page">
            <h2 class="text-xl font-bold mb-4">–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ä–µ–∑—å–±</h2>
            <div class="card overflow-x-auto">
                <table class="w-full text-left text-sm">
                    <thead><tr class="border-b"><th>–†–µ–∑—å–±–∞</th><th>–®–∞–≥</th><th>–°–≤–µ—Ä–ª–æ</th></tr></thead>
                    <tbody id="threads-table"></tbody>
                </table>
            </div>
        </section>

        <section id="page-dtc" class="page">
            <h2 class="text-xl font-bold mb-4">–ö–æ–¥—ã –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π</h2>
            <input type="text" id="dtc-search" oninput="searchDTC()" class="w-full p-3 rounded-lg border mb-4" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ (P0101)...">
            <div id="dtc-results" class="space-y-2"></div>
        </section>

        <section id="page-ai" class="page">
            <h2 class="text-xl font-bold mb-4">–ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–π AI</h2>
            <div class="grid grid-cols-2 gap-4 mb-6">
                <a href="https://gemini.google.com" target="_blank" class="card text-center py-6">Gemini</a>
                <a href="https://canva.com" target="_blank" class="card text-center py-6">Canva</a>
            </div>
            <div class="card">
                <h3 class="font-bold mb-2">–ü—Ä–æ–º—Ç –¥–Ω—è:</h3>
                <p class="text-sm italic">"–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –ø—Ä–∏—á–∏–Ω—ã –∏–∑–Ω–æ—Å–∞ –∫—É–ª–∞—á–∫–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–≤–∞–ª–∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –º–∞—Å–ª–∞ –≤—è–∑–∫–æ—Å—Ç—å—é..."</p>
            </div>
        </section>

        <section id="page-humor" class="page">
            <h2 class="text-xl font-bold mb-4">–Æ–º–æ—Ä</h2>
            <div id="joke-container" class="card text-lg italic text-center min-h-[100px] flex items-center justify-center">
                –ó–∞–≥—Ä—É–∑–∫–∞ —à—É—Ç–∫–∏...
            </div>
            <button onclick="loadJoke()" class="btn-action">–ï—â—ë –∞–Ω–µ–∫–¥–æ—Ç</button>
        </section>
    </main>

    <nav class="nav-bar">
        <button onclick="showPage('calendar')" class="nav-btn active"><span>üìÖ</span>–ö–∞–ª–µ–Ω–¥–∞—Ä—å</button>
        <button onclick="showPage('chat')" class="nav-btn"><span>üí¨</span>–ß–∞—Ç</button>
        <button onclick="showPage('warehouse')" class="nav-btn"><span>üì¶</span>–°–∫–ª–∞–¥</button>
        <button onclick="showPage('handbook')" class="nav-btn"><span>‚öôÔ∏è</span>–°–ø—Ä–∞–≤–∫–∞</button>
        <button onclick="showPage('dtc')" class="nav-btn"><span>‚ö†Ô∏è</span>DTC</button>
        <button onclick="showPage('ai')" class="nav-btn"><span>ü§ñ</span>AI</button>
        <button onclick="showPage('humor')" class="nav-btn"><span>üòÇ</span>–Æ–º–æ—Ä</button>
    </nav>

    <div id="modal-settings" class="fixed inset-0 bg-black/50 hidden z-[2000] p-6">
        <div class="bg-[var(--card)] w-full max-w-sm mx-auto rounded-2xl p-6">
            <h3 class="text-xl font-bold mb-4">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
            <p class="mb-2 text-sm">–¶–≤–µ—Ç–æ–≤–∞—è —Ç–µ–º–∞:</p>
            <div class="grid grid-cols-2 gap-2 mb-6">
                <button onclick="setTheme('classic')" class="p-2 border rounded">–ö–ª–∞—Å—Å–∏–∫–∞</button>
                <button onclick="setTheme('dark')" class="p-2 bg-gray-900 text-white rounded">–¢–µ–º–Ω–∞—è</button>
                <button onclick="setTheme('safety')" class="p-2 bg-yellow-400 text-black rounded">–¢–ë (–ñ–µ–ª—Ç–∞—è)</button>
                <button onclick="setTheme('garage')" class="p-2 bg-red-600 text-white rounded">–ì–∞—Ä–∞–∂</button>
            </div>
            <p class="mb-2 text-sm">–ü–æ–¥–∫–ª—é—á–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:</p>
            <div id="qrcode" class="flex justify-center mb-4"></div>
            <button onclick="closeSettings()" class="w-full p-2 bg-gray-200 rounded text-black font-bold">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script>
        /* --- 1. –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø FIREBASE (–ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –í–ê–®–ò –ö–õ–Æ–ß–ò) --- */
        const firebaseConfig = {
            apiKey: "AIzaSyCim3CEHVjBta4cwxLUWG8BYXEfLobwXE4",
  authDomain: "izolenta-695a7.firebaseapp.com",
  databaseURL: "https://izolenta-695a7-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "izolenta-695a7",
  storageBucket: "izolenta-695a7.firebasestorage.app",
  messagingSenderId: "450880685230",
  appId: "1:450880685230:web:2ffd2b4758e35b0337193f",
  measurementId: "G-BFMW0YSYFL"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        /* --- 2. –î–ê–ù–ù–´–ï (–ü–†–ê–ó–î–ù–ò–ö–ò, –¶–ò–¢–ê–¢–´, –†–ï–ó–¨–ë–´) --- */
        const byHolidays = ["01-01", "01-07", "03-08", "05-01", "05-09", "07-03", "11-07", "12-25"];
        const murphyQuotes = [
            "–ï—Å–ª–∏ –¥–µ—Ç–∞–ª—å –Ω–µ –ª–µ–∑–µ—Ç, –≤–æ–∑—å–º–∏ –º–æ–ª–æ—Ç–æ–∫ –ø–æ–±–æ–ª—å—à–µ.",
            "–ù–µ —Å–ª–µ–¥—É–µ—Ç –º–Ω–æ–∂–∏—Ç—å —Å—É—â–Ω–æ—Å—Ç–∏ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (–ë—Ä–∏—Ç–≤–∞ –û–∫–∫–∞–º–∞).",
            "–ò–∑ –¥–≤—É—Ö —Ä–µ—à–µ–Ω–∏–π –≤—ã–±–∏—Ä–∞–π —Å–∞–º–æ–µ –ø—Ä–æ—Å—Ç–æ–µ.",
            "–õ—é–±–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —É–ø–∞–≤—à–∏–π –∏–∑ —Ä—É–∫, –∑–∞–∫–∞—Ç–∏—Ç—Å—è –≤ —Å–∞–º—ã–π –¥–∞–ª—å–Ω–∏–π —É–≥–æ–ª."
        ];
        const threads = [
            {n: "M6", s: "1.0", d: "5.0"}, {n: "M8", s: "1.25", d: "6.8"},
            {n: "M10", s: "1.5", d: "8.5"}, {n: "1/4\" UNC", s: "20 TPI", d: "5.1"}
        ];

        /* --- 3. –õ–û–ì–ò–ö–ê –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–Ø –°–¢–†–ê–ù–ò–¶ --- */
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('page-' + pageId).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        /* --- 4. –ö–ê–õ–ï–ù–î–ê–†–¨ --- */
        let currentDate = new Date();
        function renderCalendar() {
            const body = document.getElementById('calendar-body');
            const title = document.getElementById('month-title');
            body.innerHTML = '';
            title.innerText = currentDate.toLocaleString('ru', { month: 'long', year: 'numeric' });
            
            const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1).getDay();
            const daysInMonth = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0).getDate();
            const offset = firstDay === 0 ? 6 : firstDay - 1;

            for(let i=0; i<offset; i++) body.innerHTML += '<div></div>';
            for(let d=1; d<=daysInMonth; d++) {
                const dateStr = `${currentDate.getFullYear()}-${String(currentDate.getMonth()+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
                const isHoliday = byHolidays.includes(dateStr.slice(5));
                const isToday = d === new Date().getDate() && currentDate.getMonth() === new Date().getMonth();
                body.innerHTML += `<div class="day ${isHoliday?'holiday':''} ${isToday?'today':''}">${d}</div>`;
            }
            document.getElementById('daily-quote').innerText = murphyQuotes[Math.floor(Math.random()*murphyQuotes.length)];
        }
        function moveMonth(dir) { currentDate.setMonth(currentDate.getMonth() + dir); renderCalendar(); }

        /* --- 5. –ß–ê–¢ (REALTIME) --- */
        function sendMessage() {
            const input = document.getElementById('chat-input');
            if(input.value) {
                db.ref('chat').push({ text: input.value, time: Date.now() });
                input.value = '';
            }
        }
        db.ref('chat').limitToLast(15).on('value', snap => {
            const box = document.getElementById('chat-messages');
            box.innerHTML = '';
            snap.forEach(m => {
                box.innerHTML += `<div class="p-2 bg-blue-500/10 rounded"><b>–ú–µ—Ö–∞–Ω–∏–∫:</b> ${m.val().text}</div>`;
            });
            box.scrollTop = box.scrollHeight;
        });

        /* --- 6. –ù–ê–°–¢–†–û–ô–ö–ò –ò –¢–ï–ú–´ --- */
        function openSettings() { 
            document.getElementById('modal-settings').classList.remove('hidden');
            document.getElementById('qrcode').innerHTML = "";
            new QRCode(document.getElementById("qrcode"), { text: window.location.href, width: 128, height: 128 });
        }
        function closeSettings() { document.getElementById('modal-settings').classList.add('hidden'); }
        function setTheme(t) { 
            document.body.className = 'theme-' + t; 
            localStorage.setItem('izolenta-theme', t);
        }

        /* --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø --- */
        window.onload = () => {
            document.getElementById('app-logo').innerHTML = `<svg viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="var(--main-blue)"/><circle cx="50" cy="50" r="20" fill="white"/></svg>`;
            renderCalendar();
            setTheme(localStorage.getItem('izolenta-theme') || 'classic');
            threads.forEach(t => {
                document.getElementById('threads-table').innerHTML += `<tr class="border-b"><td>${t.n}</td><td>${t.s}</td><td class="font-bold">${t.d}</td></tr>`;
            });
        };
    </script>
</body>
</html>